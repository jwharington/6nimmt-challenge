<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0038)file:///home/jmw/Downloads/6nimmt.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/">
<title>6 NIMMT!</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="nimmt">
<h1 class="title">6 NIMMT!</h1>
<h2 class="subtitle" id="communication-protocol">Communication protocol</h2>

<p><tt class="docutils literal">client</tt> and <tt class="docutils literal">server</tt> comunicate using text messages over a TCP connection. A message consists of one or more lines and ends with an empty line. The exact number of lines depends on the message type. Every message starts with an indication of its type on a single line:</p>
<pre class="literal-block">&lt;msg_type&gt;
..
&lt;empty_line&gt;
</pre>
<p>Lines consists of words separated by single spaces. There is no white space at the beginning or end of a line. All text is in lowercase except for the player names.</p>
<div class="section" id="messages">
<h1>Messages</h1>
<p>Messages are described from the viewpoint of the <tt class="docutils literal">client</tt>.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%">
<col width="10%">
<col width="80%">
</colgroup>
<thead valign="bottom">
<tr><th class="head">Type</th>
<th class="head">Direction</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">player</tt></td>
<td>out</td>
<td>First message send on a connection to identify the player name.</td>
</tr>
<tr><td><tt class="docutils literal">players</tt></td>
<td>in</td>
<td>List of players currently connected. Will be received at least once before the start of the game.</td>
</tr>
<tr><td><tt class="docutils literal">cards</tt></td>
<td>in</td>
<td>Receiving cards at the start of a new game.</td>
</tr>
<tr><td><tt class="docutils literal">stacks</tt></td>
<td>in</td>
<td>Current stacks. Received whenever the stacks have changed, thus will be received once for each card played by all players.</td>
</tr>
<tr><td><tt class="docutils literal">card?</tt></td>
<td>in</td>
<td>Request to play a card.</td>
</tr>
<tr><td><tt class="docutils literal">card</tt></td>
<td>out</td>
<td>Card being played</td>
</tr>
<tr><td><tt class="docutils literal">played</tt></td>
<td>in</td>
<td>Shows the cards that are being played, by whom and on what stack it ended up. One message per player.</td>
</tr>
<tr><td><tt class="docutils literal">stack?</tt></td>
<td>in</td>
<td>Select a stack. Card played doesn't fit any stack and the player must chose one. Includes information about the cards other players will still need to play.</td>
</tr>
<tr><td><tt class="docutils literal">stack</tt></td>
<td>out</td>
<td>Stack selection</td>
</tr>
<tr><td><tt class="docutils literal">score</tt></td>
<td>in</td>
<td>Player scores</td>
</tr>
<tr><td><tt class="docutils literal">info</tt></td>
<td>in</td>
<td>Info messages from the <tt class="docutils literal">server</tt></td>
</tr>
</tbody>
</table>
<p>Then there are also messages to control the game. They go over a separate TCP connection.</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%">
<col width="10%">
<col width="80%">
</colgroup>
<thead valign="bottom">
<tr><th class="head">Type</th>
<th class="head">Direction</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td><tt class="docutils literal">control</tt></td>
<td>out</td>
<td>First message send on the connection to indicate it is the control connection.</td>
</tr>
<tr><td><tt class="docutils literal">players</tt></td>
<td>in</td>
<td>List of players currently connected.</td>
</tr>
<tr><td><tt class="docutils literal">start</tt></td>
<td>out</td>
<td>Start the game</td>
</tr>
<tr><td><tt class="docutils literal">stop</tt></td>
<td>out</td>
<td>Stop the game. Only needed to stop a game in progress.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="message-format">
<h1>Message format</h1>
<dl class="docutils">
<dt><tt class="docutils literal">player</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">player
ErikTheViking
</pre>
</dd>
<dt><tt class="docutils literal">players</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">players
JWaz loids EriktheViking
</pre>
</dd>
<dt><tt class="docutils literal">cards</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">cards
2 23 45 55 76 88 89 91 95 104
</pre>
</dd>
<dt><tt class="docutils literal">stacks</tt></dt>
<dd><p class="first">Stack status is reduced to just showing the number of cards on the stack, total points and the top card number.</p>
<p>Example:</p>
<pre class="last literal-block">stacks
1 1 2
0 0 0
4 12 88
3 3 25
</pre>
</dd>
<dt><tt class="docutils literal">card?</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">card?
</pre>
</dd>
<dt><tt class="docutils literal">card</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">card
88
</pre>
</dd>
<dt><tt class="docutils literal">played</tt></dt>
<dd><p class="first">Shows the card being played by a player. There is only one line for one player: &lt;player_name&gt;&nbsp;&lt;card&gt;&nbsp;&lt;stack&gt;. Stacks are number numbered from 1.</p>
<p>Example:</p>
<pre class="last literal-block">played
loids 8 1
</pre>
</dd>
<dt><tt class="docutils literal">stack?</tt></dt>
<dd><p class="first">Select the stack the card needs to be placed at. This request comes when the card being played doesn't fit any stack. This message includes the information about the cards yet to be stacked including the one currently requested a stack for.</p>
<p>Example:</p>
<pre class="last literal-block">stack?
JWaz 14 EriktheViking 22
</pre>
</dd>
<dt><tt class="docutils literal">stack</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">stack
4
</pre>
</dd>
<dt><tt class="docutils literal">score</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">score
JWaz 66 loids 66 EriktheViking 66
</pre>
</dd>
<dt><tt class="docutils literal">info</tt></dt>
<dd><p class="first">Example:</p>
<pre class="last literal-block">info
This is just to inform you of something.
</pre>
</dd>
</dl>
</div>
<div class="section" id="network-programming">
<h1>Network programming</h1>
<p>The game <tt class="docutils literal">server</tt> can be reached at <tt class="docutils literal">ipsm.makarta.com:9999</tt>. Many languages support network programming allowing you to use a TCP socket as a stream to read from or write to. If however you don't want to dive into network programming yet or your language of choice doesn't support it you can instead use <tt class="docutils literal">socat</tt>. Write your program to read from <tt class="docutils literal">stdin</tt> and <tt class="docutils literal">stdout</tt> and have <tt class="docutils literal">socat</tt> pipe it to the game <tt class="docutils literal">server</tt> like this:</p>
<pre class="literal-block">socat TCP:ipsm.makarta.com:9999 EXEC:my_game_bot
</pre>
<p>Reading from <tt class="docutils literal">stdin</tt> and writing to <tt class="docutils literal">stdout</tt> can be done in Python this way:</p>
<pre class="literal-block"># Reading a line
line = sys.stdin.readline()

# Writing a message
print("player\nErikTheViking\n\n")

# Or even
sys.stdout.write("player\nErikTheViking\n\n")
sys.stdout.flush()
</pre>
<p>It is good to know if and how your language and libraries you use buffer output. It is common for text streams to be line buffered. This means whenever a new line is encountered the internal buffer holding the line is flushed to the output stream automatically. For binary streams this is not the case, you will need to flush them explicitly at the end of the message otherwise they'll just sit in the buffer and don't actually go out until the buffer has sufficiently filled up.</p>
</div>
</div>


</body></html>